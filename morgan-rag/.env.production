# =============================================================================
# Morgan v2-0.0.1 Production Configuration
# =============================================================================
# Production-ready configuration with security hardened settings
# Copy to .env and customize for your production environment
#
# IMPORTANT SECURITY NOTES:
# 1. Change ALL default passwords and secrets!
# 2. Use strong, randomly generated passwords (minimum 32 characters)
# 3. Enable authentication on all services
# 4. Use TLS/SSL for all external connections
# 5. Restrict CORS to specific domains only
# 6. Never commit this file to version control!
# =============================================================================

# =============================================================================
# LLM Configuration
# =============================================================================

LLM_BASE_URL=https://gpt.lazarev.cloud/ollama/v1
LLM_API_KEY=REPLACE_WITH_YOUR_PRODUCTION_API_KEY
LLM_MODEL=llama3.1:8b
LLM_CHAT_MODEL=llama3.1:8b
LLM_EMBEDDING_MODEL=qwen3-embedding:latest

MORGAN_EXTERNAL_LLM_API_BASE=https://gpt.lazarev.cloud/ollama/v1
MORGAN_EXTERNAL_LLM_API_KEY=REPLACE_WITH_YOUR_PRODUCTION_API_KEY
MORGAN_LLM_SERVICE_URL=http://llm-service:8001

# =============================================================================
# Database Configuration
# =============================================================================

POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=morgan_production
POSTGRES_USER=morgan_prod
POSTGRES_PASSWORD=REPLACE_WITH_STRONG_PASSWORD_MIN_32_CHARS

DATABASE_URL=postgresql://morgan_prod:REPLACE_WITH_STRONG_PASSWORD_MIN_32_CHARS@postgres:5432/morgan_production

# =============================================================================
# Redis Configuration
# =============================================================================

REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=REPLACE_WITH_STRONG_REDIS_PASSWORD
REDIS_DB=0
REDIS_URL=redis://:REPLACE_WITH_STRONG_REDIS_PASSWORD@redis:6379/0

# Increase cache for production
MORGAN_CACHE_SIZE=5000
MORGAN_CACHE_TTL=7200

# =============================================================================
# Vector Database (Qdrant)
# =============================================================================

QDRANT_HOST=qdrant
QDRANT_PORT=6333
QDRANT_GRPC_PORT=6334
QDRANT_URL=http://qdrant:6333
QDRANT_API_KEY=REPLACE_WITH_QDRANT_API_KEY

QDRANT_DEFAULT_COLLECTION=morgan_knowledge_prod
QDRANT_MEMORY_COLLECTION=morgan_memory_prod
QDRANT_LOG_LEVEL=WARNING

# =============================================================================
# Embedding Configuration
# =============================================================================

EMBEDDING_MODEL=qwen3-embedding:latest
EMBEDDING_LOCAL_MODEL=all-MiniLM-L6-v2
EMBEDDING_FORCE_REMOTE=true
EMBEDDING_BATCH_SIZE=100
EMBEDDING_DEVICE=cpu
EMBEDDING_USE_INSTRUCTIONS=true

# =============================================================================
# Service URLs
# =============================================================================

MORGAN_TTS_SERVICE_URL=http://tts-service:8002
MORGAN_STT_SERVICE_URL=http://stt-service:8003

# =============================================================================
# System Configuration
# =============================================================================

MORGAN_DATA_DIR=/app/data
MORGAN_CONFIG_DIR=/app/config
MORGAN_LOG_LEVEL=INFO
MORGAN_DEBUG=false
MORGAN_MAX_CONTEXT=8192
MORGAN_MAX_RESPONSE_TOKENS=2048

# =============================================================================
# Performance Settings
# =============================================================================

# Scale up workers for production
MORGAN_WORKERS=8
MORGAN_MAX_SEARCH_RESULTS=50
MORGAN_DEFAULT_SEARCH_RESULTS=10

# =============================================================================
# Security Settings - CRITICAL!
# =============================================================================

# Generate with: openssl rand -hex 32
MORGAN_API_KEY=REPLACE_WITH_SECURE_API_KEY_USE_OPENSSL_RAND

# IMPORTANT: Replace * with your actual domains!
# Example: https://app.yourdomain.com,https://admin.yourdomain.com
MORGAN_CORS_ORIGINS=https://your-production-domain.com

# Restrict features in production
MORGAN_ALLOW_FILE_UPLOAD=true
MORGAN_ALLOW_URL_INGESTION=true
MORGAN_ALLOW_CODE_EXECUTION=false

# Generate with: openssl rand -hex 32
MORGAN_SESSION_SECRET=REPLACE_WITH_SECURE_SESSION_SECRET_USE_OPENSSL_RAND

# =============================================================================
# Web Interface & API Configuration
# =============================================================================

MORGAN_HOST=0.0.0.0
MORGAN_PORT=8080
MORGAN_API_PORT=8000
MORGAN_WEB_ENABLED=true

# Disable docs in production for security
MORGAN_DOCS_ENABLED=false

# Enable in production for monitoring
MORGAN_REQUEST_LOGGING=true

# =============================================================================
# Document Ingestion Settings
# =============================================================================

MORGAN_CHUNK_SIZE=1000
MORGAN_CHUNK_OVERLAP=200
MORGAN_MAX_FILE_SIZE=100
MORGAN_SUPPORTED_TYPES=pdf,docx,txt,md,html,py,js,ts,go,java,cpp,c,h,json,yaml,yml
MORGAN_SCRAPE_DEPTH=3
MORGAN_SCRAPE_DELAY=1
MORGAN_SCRAPE_TIMEOUT=30

# =============================================================================
# Memory & Learning
# =============================================================================

# Scale up for production
MORGAN_MEMORY_ENABLED=true
MORGAN_MEMORY_MAX_CONVERSATIONS=10000
MORGAN_MEMORY_MAX_TURNS_PER_CONVERSATION=200
MORGAN_LEARNING_ENABLED=true
MORGAN_FEEDBACK_WEIGHT=0.1
MORGAN_KNOWLEDGE_GRAPH_ENABLED=true
MORGAN_ENTITY_EXTRACTION_ENABLED=true

# =============================================================================
# Feature Flags
# =============================================================================

MORGAN_ENABLE_MEMORY=true
MORGAN_ENABLE_TOOLS=true
MORGAN_ENABLE_PROMETHEUS=true

# =============================================================================
# Monitoring & Analytics
# =============================================================================

MORGAN_METRICS_ENABLED=true
MORGAN_METRICS_PORT=9000
MORGAN_HEALTH_CHECK_INTERVAL=30
MORGAN_ANALYTICS_RETENTION=180

# =============================================================================
# CUDA Configuration
# =============================================================================

CUDA_VISIBLE_DEVICES=0
LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64
CUDA_LAUNCH_BLOCKING=0
TORCH_USE_CUDA_DSA=0

# =============================================================================
# HuggingFace Configuration
# =============================================================================

HF_TOKEN=REPLACE_WITH_YOUR_HF_TOKEN
HUGGINGFACE_HUB_TOKEN=REPLACE_WITH_YOUR_HF_TOKEN
HF_HOME=/root/.cache/huggingface
HF_HUB_CACHE=/root/.cache/huggingface/hub
HF_DATASETS_CACHE=/root/.cache/huggingface/datasets
TRANSFORMERS_CACHE=/root/.cache/huggingface/transformers

# =============================================================================
# PyTorch Configuration
# =============================================================================

TORCH_HOME=/root/.cache/torch
XDG_CACHE_HOME=/root/.cache
SENTENCE_TRANSFORMERS_HOME=/root/.cache/torch/sentence_transformers

# =============================================================================
# Production Settings
# =============================================================================

MORGAN_DEV_MODE=false
MORGAN_AUTO_RELOAD=false
PYTHONPATH=/app
BEHIND_PROXY=true

# =============================================================================
# Monitoring Services
# =============================================================================

# Use strong password!
GRAFANA_PASSWORD=REPLACE_WITH_STRONG_GRAFANA_PASSWORD

# =============================================================================
# Environment Indicator
# =============================================================================

MORGAN_ENVIRONMENT=production
